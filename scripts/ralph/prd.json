{
  "project": "Baisics",
  "branchName": "ralph/hi-route-refactor",
  "description": "Fix issues found in PR #291 review - error handling, dead code, missing imports",
  "userStories": [
    {
      "id": "US-001",
      "title": "Fix undefined createNewProgram function",
      "description": "Remove or fix the handleSaveProgram function that references undefined createNewProgram.",
      "acceptanceCriteria": [
        "In src/app/hi/components/ConversationalInterface.tsx, find handleSaveProgram around line 425",
        "Either import createNewProgram from '@/lib/actions/program' OR remove the dead code entirely if unused",
        "Remove the @ts-ignore comment",
        "npm run typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CRITICAL: This will throw ReferenceError at runtime if triggered."
    },
    {
      "id": "US-002",
      "title": "Add error handling to handleInitialIntake",
      "description": "Add proper error handling for the failure case in handleInitialIntake.",
      "acceptanceCriteria": [
        "In ConversationalInterface.tsx, find handleInitialIntake function",
        "Add try-catch wrapper around the processUserMessage call",
        "Handle success: false case - show user-friendly message",
        "Set isTyping to false on error",
        "npm run typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": "Currently ignores failures completely, leaving users with infinite typing indicator."
    },
    {
      "id": "US-003",
      "title": "Add try-catch to handleProgramModification",
      "description": "Wrap handleProgramModification in try-catch to handle network errors.",
      "acceptanceCriteria": [
        "In ConversationalInterface.tsx, find handleProgramModification function",
        "Wrap the processModificationRequest call in try-catch",
        "On error, log it, set isGeneratingProgram false, show user message",
        "Use finally block to ensure state cleanup",
        "npm run typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": "Network errors can crash the component without this."
    },
    {
      "id": "US-004",
      "title": "Handle blank=true query param in /create",
      "description": "Make the ?blank=true query param functional in /create page.",
      "acceptanceCriteria": [
        "In src/app/create/page.tsx, read the 'blank' query param",
        "If blank=true, default to text input mode with empty textarea ready for input",
        "Optionally show a heading like 'Build Your Program' instead of 'Import'",
        "npm run typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": "Currently /templates links to /create?blank=true but param is ignored."
    },
    {
      "id": "US-005",
      "title": "Add text input size limit to API",
      "description": "Add a size limit for text input in the import API to match file upload limits.",
      "acceptanceCriteria": [
        "In src/app/api/programs/import/route.ts, add check for text field length",
        "Limit to reasonable size (e.g., 50000 characters / ~50KB)",
        "Return clear error if exceeded: 'Text input too long. Maximum 50,000 characters.'",
        "npm run typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": "File uploads have 10MB limit but text has none currently."
    },
    {
      "id": "US-006",
      "title": "Add try-catch around mammoth extraction",
      "description": "Wrap mammoth.extractRawText in try-catch for better DOCX error handling.",
      "acceptanceCriteria": [
        "In src/app/api/programs/import/route.ts, find the mammoth.extractRawText call",
        "Wrap it in try-catch",
        "On error, return user-friendly message: 'Unable to read your Word document. It may be corrupted or password-protected.'",
        "npm run typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": "Corrupted DOCX files currently show generic 'Server error'."
    },
    {
      "id": "US-007",
      "title": "Clean up unused imports and state in /create",
      "description": "Remove unused GripVertical import and savedProgramId state.",
      "acceptanceCriteria": [
        "In src/app/create/page.tsx, remove GripVertical from lucide-react import if unused",
        "Remove savedProgramId state if it's set but never read",
        "npm run typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": "Minor cleanup for code quality."
    }
  ]
}
